% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlacion_heatmap.R
\name{correlacion_heatmap}
\alias{correlacion_heatmap}
\title{Matriz de Correlación/Asociación y Heatmap}
\usage{
correlacion_heatmap(
  datos,
  variables = NULL,
  metodo = "pearson",
  manejo_na = "pairwise",
  mostrar_heatmap = TRUE,
  digits = 2,
  ...
)
}
\arguments{
\item{datos}{Un data frame que contiene las variables.}

\item{variables}{Un vector opcional de nombres o índices de columnas a incluir.
Si es NULL (por defecto), se usarán todas las variables numéricas y factores.
Las columnas de tipo 'character' se convertirán a factores.}

\item{metodo}{El método de correlación/asociación a usar. Uno de:
"pearson" (def.), "spearman", "kendall", "phi", "pointbiserial", "cramersv".}

\item{manejo_na}{Cómo manejar NAs: "pairwise" (def.) usa casos completos para
cada par; "complete" usa solo filas completas para todas las variables
seleccionadas \emph{antes} de calcular.}

\item{mostrar_heatmap}{Booleano. ¿Mostrar un mapa de calor de la matriz? Por defecto TRUE.}

\item{digits}{Número de decimales para redondear coeficientes en el heatmap. Por defecto 2.}

\item{...}{Argumentos adicionales pasados a \code{ggcorrplot::ggcorrplot}
(ej. \code{hc.order = TRUE}, \code{type = 'lower'}, \code{colors = c("blue", "white", "red")}).}
}
\value{
Una matriz cuadrada que contiene los coeficientes calculados para los
pares compatibles con el método elegido, y \code{NA} en los demás casos. La diagonal
se establece en 1 para las variables donde el método es aplicable a sí misma
(numéricas para Pearson/Spearman/Kendall, factores para Phi/CramerV), y NA
en otros casos (PointBiserial). Devuelve \code{NULL} si no hay variables válidas
para el método elegido.
}
\description{
Calcula una matriz de correlación o asociación para variables seleccionadas
usando un único método especificado por el usuario. El método se aplica
solo a los pares de variables compatibles.
}
\details{
Métodos disponibles y pares compatibles:
\itemize{
\item "pearson", "spearman", "kendall": Numérica vs Numérica.
\item "phi": Dicotómica vs Dicotómica (factor con 2 niveles).
\item "pointbiserial": Numérica vs Dicotómica.
\item "cramersv": Categórica vs Categórica (factor con >= 2 niveles).
}
}
\examples{
# Crear datos mixtos de ejemplo
set.seed(123)
df_mixto <- data.frame(
  Edad = rnorm(100, 40, 10),
  Ingresos = rnorm(100, 50000, 15000),
  Genero = factor(sample(c("M", "F"), 100, replace = TRUE)),
  Educacion = factor(sample(c("Basica", "Media", "Superior", NA), 100,
                            replace = TRUE, prob = c(0.2, 0.4, 0.3, 0.1))),
  Compra = factor(sample(c("Si", "No"), 100, replace = TRUE)),
  Satisfaccion = sample(1:5, 100, replace = TRUE), # Tratar como factor
  Activo = sample(0:1, 100, replace=TRUE) # Numérica binaria
)
df_mixto$Satisfaccion <- factor(df_mixto$Satisfaccion, ordered = TRUE) # Factor ordenado
df_mixto$Edad[sample(1:100, 5)] <- NA # Añadir NAs

# Calcular solo Pearson (Num vs Num)
correlacion_heatmap(df_mixto, metodo = "pearson", digits = 2)

\dontrun{
# Calcular solo Phi (Dicótoma vs Dicótoma)
correlacion_heatmap(df_mixto, metodo = "phi", variables = c("Genero", "Compra", "Activo"))
# Nota: Activo es numérica 0/1, se tratará como dicotómica si se convierte a factor primero.
#       La función actual no lo hace automáticamente para 'phi', requeriría preparación previa.
#       Modifiquemos para que trate factores con 2 niveles.

# Calcular solo Point-Biserial (Num vs Dicótoma)
# (Visualizará la relación Edad-Genero, Ingresos-Genero, Edad-Compra, Ingresos-Compra)
correlacion_heatmap(df_mixto, metodo = "pointbiserial",
                   variables = c("Edad", "Ingresos", "Genero", "Compra"), digits = 3)

# Calcular solo Cramer's V (Cat vs Cat)
correlacion_heatmap(df_mixto, metodo = "cramersv",
                   variables = c("Genero", "Educacion", "Compra", "Satisfaccion"),
                   hc.order = TRUE, type = "lower", digits=2)
}

}
